angular.module("sbDateSelect",[]).directive("sbDateSelect",[function(){return{restrict:"A",replace:!0,template:['<div class="sb-date-select">','<select class="sb-date-select-day sb-date-select-select" ng-class="selectClass" ng-model="date", ng-options="d for d in dates track by d">',"<option value disabled selected>Day</option>","</select>",'<select class="sb-date-select-month sb-date-select-select" ng-class="selectClass" ng-model="month", ng-options="m.value as m.name for m in months">',"<option value disabled>Month</option>","</select>",'<select class="sb-date-select-year sb-date-select-select" ng-class="selectClass" ng-model="year" ng-options="y for y in years">',"<option value disabled selected>Year</option>","</select>","</div>"].join(""),require:"ngModel",scope:{selectClass:"@sbSelectClass",min:"@min",max:"@max"},link:function(e,t,a,n){function s(){e.years=[];for(var t=c.year();t>=m.year();t--)e.years.push(t)}function o(){e.months=[];for(var t=e.year&&m.isSame([e.year],"year")?m.month():0,a=e.year&&c.isSame([e.year],"year")?c.month():11,n=moment.months(),s=t;s<=a;s++)e.months.push({name:n[s],value:s+1});(e.month-1>a||e.month-1<t)&&delete e.month}function l(t,a){var n,s;n=e.year&&e.month&&m.isSame([e.year,e.month-1],"month")?m.date():1,s=e.year&&e.month&&c.isSame([e.year,e.month-1],"month")?c.date():e.year&&e.month?moment([e.year,e.month-1]).daysInMonth():31,e.dates=[];for(var o=n;o<=s;o++)e.dates.push(o);(e.date<n||e.date>s)&&delete e.date}var m,c;e.$watchCollection("[min, max]",function(e){m=moment(e[0]||"1900-01-01"),c=moment(e[1]),l(),o(),s()}),e.$watch("year",function(){o()}),e.$watchCollection("[month, year]",function(){l()}),e.$watchCollection("[date, month, year]",function(){if(e.year&&e.month&&e.date){var t=moment([e.year,e.month-1,e.date]);n.$setViewValue(t.format("YYYY-MM-DD"))}else n.$setViewValue()}),n.$render=function(){if(n.$viewValue){var t=moment(n.$viewValue);e.year=t.year(),e.month=t.month()+1,e.date=t.date()}}}}}]);